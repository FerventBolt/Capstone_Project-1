"use strict";(()=>{var e={};e.id=5535,e.ids=[5535],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},69292:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>_,patchFetch:()=>g,requestAsyncStorage:()=>D,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var r={};t.r(r),t.d(r,{DELETE:()=>m,GET:()=>d,POST:()=>u,PUT:()=>l});var n=t(40263),i=t(86642),o=t(43575),a=t(23082);async function d(e){try{let s=(e.headers.get("cookie")||"").split(";").find(e=>e.trim().startsWith("demo-session=")),t=null;if(s)try{let e=decodeURIComponent(s.split("=")[1]);t=JSON.parse(e),console.log("\uD83D\uDD0D DEBUG: Found demo session in Reminders GET API:",t)}catch(e){return console.error("\uD83D\uDD0D DEBUG: Error parsing demo session in Reminders GET API:",e),a.NextResponse.json({error:"Invalid session"},{status:401})}if(!t||!t.authenticated||!["admin","staff"].includes(t.role))return console.log("\uD83D\uDD0D DEBUG: Authentication failed - userSession:",t),a.NextResponse.json({error:"Unauthorized - Admin/Staff access required"},{status:403});console.log("\uD83D\uDD0D DEBUG: Authentication successful for Reminders GET:",t.email);let r=[{id:"1",title:"Welcome to CTE Learning Platform",message:"Welcome to our comprehensive Technical Education platform! Explore your courses and start your learning journey.",reminder_type:"announcement",priority:"medium",target_audience:"all_students",target_user_ids:[],target_course_ids:[],target_emails:[],is_active:!0,is_dismissible:!0,expires_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_user:{id:"admin1",first_name:"Admin",last_name:"User",email:"admin@lpu.edu.ph",role:"admin"}},{id:"2",title:"Assignment Deadline Reminder",message:"Don't forget to submit your pending assignments before the deadline. Check your course dashboard for details.",reminder_type:"deadline",priority:"high",target_audience:"all_students",target_user_ids:[],target_course_ids:[],target_emails:[],is_active:!0,is_dismissible:!0,expires_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_user:{id:"staff1",first_name:"Maria",last_name:"Santos",email:"maria.santos@lpu.edu.ph",role:"staff"}},{id:"3",title:"System Maintenance Notice",message:"Scheduled maintenance will occur this weekend from 2:00 AM to 6:00 AM. Some features may be temporarily unavailable.",reminder_type:"maintenance",priority:"urgent",target_audience:"all_users",target_user_ids:[],target_course_ids:[],target_emails:[],is_active:!0,is_dismissible:!1,expires_at:new Date(Date.now()+6048e5).toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_user:{id:"admin1",first_name:"Admin",last_name:"User",email:"admin@lpu.edu.ph",role:"admin"}}];return a.NextResponse.json({reminders:r,pagination:{page:1,limit:10,total:r.length,totalPages:1}})}catch(e){return console.error("Error in GET /api/admin/reminders:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}async function u(e){try{let s=(e.headers.get("cookie")||"").split(";").find(e=>e.trim().startsWith("demo-session=")),t=null;if(s)try{let e=decodeURIComponent(s.split("=")[1]);t=JSON.parse(e),console.log("\uD83D\uDD0D DEBUG: Found demo session in Reminders POST API:",t)}catch(e){return console.error("\uD83D\uDD0D DEBUG: Error parsing demo session in Reminders POST API:",e),a.NextResponse.json({error:"Invalid session"},{status:401})}if(!t||!t.authenticated||!["admin","staff"].includes(t.role))return console.log("\uD83D\uDD0D DEBUG: Authentication failed - userSession:",t),a.NextResponse.json({error:"Unauthorized - Admin/Staff access required"},{status:403});console.log("\uD83D\uDD0D DEBUG: Authentication successful for Reminders POST:",t.email);let{title:r,message:n,reminder_type:i,priority:o,target_audience:d,target_user_ids:u,target_course_ids:l,target_emails:m,expires_at:c,is_dismissible:D}=await e.json();if(!r||!n)return a.NextResponse.json({error:"Title and message are required"},{status:400});if("staff"===t.role&&!["all_students","specific_students","specific_emails","course_students"].includes(d))return a.NextResponse.json({error:"Staff can only send reminders to students"},{status:403});let p={id:Date.now().toString(),title:r,message:n,reminder_type:i||"general",priority:o||"medium",target_audience:d||"all_students",target_user_ids:u||[],target_course_ids:l||[],target_emails:m||[],expires_at:c||null,is_dismissible:void 0===D||D,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_user:{id:t.email,first_name:t.name?.split(" ")[0]||"User",last_name:t.name?.split(" ").slice(1).join(" ")||"",email:t.email,role:t.role}};return a.NextResponse.json({reminder:p,message:"Reminder created successfully (demo mode)"},{status:201})}catch(e){return console.error("Error in POST /api/admin/reminders:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(e){try{let s=(e.headers.get("cookie")||"").split(";").find(e=>e.trim().startsWith("demo-session=")),t=null;if(s)try{let e=decodeURIComponent(s.split("=")[1]);t=JSON.parse(e),console.log("\uD83D\uDD0D DEBUG: Found demo session in Reminders PUT API:",t)}catch(e){return console.error("\uD83D\uDD0D DEBUG: Error parsing demo session in Reminders PUT API:",e),a.NextResponse.json({error:"Invalid session"},{status:401})}if(!t||!t.authenticated||!["admin","staff"].includes(t.role))return console.log("\uD83D\uDD0D DEBUG: Authentication failed - userSession:",t),a.NextResponse.json({error:"Unauthorized - Admin/Staff access required"},{status:403});console.log("\uD83D\uDD0D DEBUG: Authentication successful for Reminders PUT:",t.email);let{id:r,target_audience:n,...i}=await e.json();if(!r)return a.NextResponse.json({error:"Reminder ID is required"},{status:400});if("staff"===t.role&&n&&!["all_students","specific_students","specific_emails","course_students"].includes(n))return a.NextResponse.json({error:"Staff can only send reminders to students"},{status:403});let o={id:r,target_audience:n,...i,updated_at:new Date().toISOString(),created_by_user:{id:t.email,first_name:t.name?.split(" ")[0]||"User",last_name:t.name?.split(" ").slice(1).join(" ")||"",email:t.email,role:t.role}};return a.NextResponse.json({reminder:o,message:"Reminder updated successfully (demo mode)"})}catch(e){return console.error("Error in PUT /api/admin/reminders:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let s=(e.headers.get("cookie")||"").split(";").find(e=>e.trim().startsWith("demo-session=")),t=null;if(s)try{let e=decodeURIComponent(s.split("=")[1]);t=JSON.parse(e),console.log("\uD83D\uDD0D DEBUG: Found demo session in Reminders DELETE API:",t)}catch(e){return console.error("\uD83D\uDD0D DEBUG: Error parsing demo session in Reminders DELETE API:",e),a.NextResponse.json({error:"Invalid session"},{status:401})}if(!t||!t.authenticated||!["admin","staff"].includes(t.role))return console.log("\uD83D\uDD0D DEBUG: Authentication failed - userSession:",t),a.NextResponse.json({error:"Unauthorized - Admin/Staff access required"},{status:403});console.log("\uD83D\uDD0D DEBUG: Authentication successful for Reminders DELETE:",t.email);let{searchParams:r}=new URL(e.url);if(!r.get("id"))return a.NextResponse.json({error:"Reminder ID is required"},{status:400});return a.NextResponse.json({message:"Reminder deleted successfully (demo mode)"})}catch(e){return console.error("Error in DELETE /api/admin/reminders:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/reminders/route",pathname:"/api/admin/reminders",filename:"route",bundlePath:"app/api/admin/reminders/route"},resolvedPagePath:"C:\\CapstoneProject\\Capstone_Project-main\\src\\app\\api\\admin\\reminders\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:D,staticGenerationAsyncStorage:p,serverHooks:f}=c,_="/api/admin/reminders/route";function g(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[3469,4507],()=>t(69292));module.exports=r})();