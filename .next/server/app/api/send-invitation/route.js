"use strict";(()=>{var e={};e.id=555,e.ids=[555],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},20661:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>q,requestAsyncStorage:()=>v,routeModule:()=>c,serverHooks:()=>S,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{POST:()=>l});var o=t(40263),i=t(86642),n=t(43575),a=t(23082),p=t(75042),u=t(64385);let d=(0,p.eI)("https://gcvvoixmucjbhxfqfkxl.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function l(e){try{let{email:r,role:t,invitedBy:s}=await e.json();if(!r||!t||!s)return a.NextResponse.json({error:"Missing required field(s)"},{status:400});let o=Math.random().toString(36).substring(2,8).toUpperCase(),i=new Date().toISOString(),n=new Date(Date.now()+6048e5).toISOString(),{error:p}=await d.from("invitations").insert([{code:o,email:r,role:t,invited_by:s,status:"pending",sent_at:i,expires_at:n}]);if(p)return console.error("Supabase insert error:",p),a.NextResponse.json({error:"Error inserting invitation",details:p.message},{status:500});let l=u.createTransport({host:process.env.SMTP_HOST,port:Number(process.env.SMTP_PORT)||587,secure:"465"===process.env.SMTP_PORT,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASSWORD}});return await l.sendMail({from:`"CTE SkillsHub" <${process.env.SMTP_USER}>`,to:r,subject:"Your CTE SkillsHub Invitation Code",html:`
        <p>Hello,</p>
        <p>You have been invited to join CTE SkillsHub.</p>
        <p>Your invitation code is:</p>
        <h2>${o}</h2>
        <p>This code will expire in 7 days.</p>
        <p>Thank you!</p>
      `}),a.NextResponse.json({message:"Invitation sent successfully."})}catch(e){return console.error("Unhandled error in send-invitation API:",e),a.NextResponse.json({error:"Internal server error",details:e.message},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/send-invitation/route",pathname:"/api/send-invitation",filename:"route",bundlePath:"app/api/send-invitation/route"},resolvedPagePath:"C:\\CapstoneProject\\Capstone_Project-main\\src\\app\\api\\send-invitation\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:S}=c,h="/api/send-invitation/route";function q(){return(0,n.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:x})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3469,4507,3677],()=>t(20661));module.exports=s})();