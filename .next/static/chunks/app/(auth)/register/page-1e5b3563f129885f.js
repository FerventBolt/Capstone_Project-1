(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9566],{7868:function(e,t,a){Promise.resolve().then(a.bind(a,1565))},1565:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var i=a(9692),s=a(9693),n=a(1509),l=a(2727),r=a(6553),d=a(4771);function o(){let[e,t]=(0,s.useState)({invitationCode:"",otp:"",firstName:"",lastName:"",middleName:"",password:"",confirmPassword:"",phoneNumber:"",dateOfBirth:"",address:""}),[a,o]=(0,s.useState)(1),[c,m]=(0,s.useState)(!1),[u,x]=(0,s.useState)(""),[h,b]=(0,s.useState)(null),p=(0,n.useRouter)(),f=e=>{let{name:a,value:i}=e.target;t(e=>({...e,[a]:i}))},v=async t=>{var a,i,s;if(t.preventDefault(),m(!0),x(""),!e.invitationCode.trim()){x("Invitation code is required."),m(!1);return}let{data:n,error:l}=await r.O.from("invitations").select("*").eq("code",e.invitationCode.trim()).single();if(l||!n){x("Invalid invitation code. Please check and try again."),m(!1);return}try{let t=await d.Z.post("/api/send-otp",{code:e.invitationCode.trim()});200===t.status?(b({email:n.email,role:n.role,invitedBy:n.invited_by}),o(2)):x((null===(a=t.data)||void 0===a?void 0:a.error)||"Failed to send OTP. Try again.")}catch(e){x((null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.error)||"Failed to send OTP. Try again.")}m(!1)},N=async t=>{t.preventDefault(),m(!0),x("");let{data:a,error:i}=await r.O.from("invitations").select("otp").eq("code",e.invitationCode.trim()).single();i||!a?x("Could not verify code. Try again."):e.otp.trim()===String(a.otp).trim()?o(3):x("Invalid OTP. Please check your email and try again."),m(!1)},g=async()=>{var t,a,i;m(!0),x("");try{let a=await d.Z.post("/api/send-otp",{code:e.invitationCode.trim()});200===a.status?x("A new verification code has been sent to your email."):x((null===(t=a.data)||void 0===t?void 0:t.error)||"Failed to resend verification code.")}catch(e){x((null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.error)||"Failed to resend verification code.")}m(!1)},y=async t=>{if(t.preventDefault(),m(!0),x(""),e.password!==e.confirmPassword){x("Passwords do not match."),m(!1);return}if(e.password.length<8){x("Password must be at least 8 characters long."),m(!1);return}try{let{error:t}=await r.O.from("profiles").insert([{email:h.email,first_name:e.firstName,last_name:e.lastName,middle_name:e.middleName,phone_number:e.phoneNumber,date_of_birth:e.dateOfBirth,address:e.address,role:h.role,invited_by:h.invitedBy}]);t?x("Failed to create account. Please try again."):p.push("/login?message=Registration successful. Please sign in.")}catch(e){x("Failed to create account. Please try again.")}finally{m(!1)}};return(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,i.jsx)("div",{className:"max-w-md w-full space-y-8 p-8",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Join CTE SkillsHub with your invitation"}),(0,i.jsx)("div",{className:"flex justify-center mt-6",children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(a>=1?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:"1"}),(0,i.jsx)("div",{className:"w-8 h-1 ".concat(a>=2?"bg-blue-600":"bg-gray-200")}),(0,i.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(a>=2?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:"2"}),(0,i.jsx)("div",{className:"w-8 h-1 ".concat(a>=3?"bg-blue-600":"bg-gray-200")}),(0,i.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(a>=3?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:"3"})]})})]}),u&&(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:u}),1===a&&(0,i.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"invitationCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Invitation Code"}),(0,i.jsx)("input",{id:"invitationCode",name:"invitationCode",type:"text",required:!0,value:e.invitationCode,onChange:f,className:"input-field",placeholder:"Enter your invitation code"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the invitation code sent to your email"})]}),(0,i.jsx)("button",{type:"submit",disabled:c,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Validating...":"Validate Invitation"})]}),2===a&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:(0,i.jsxs)("p",{className:"text-sm text-blue-800",children:["We've sent a 6-digit code to ",(0,i.jsx)("strong",{children:null==h?void 0:h.email})]})}),(0,i.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),(0,i.jsx)("input",{id:"otp",name:"otp",type:"text",required:!0,maxLength:6,value:e.otp,onChange:f,className:"input-field text-center text-2xl tracking-widest",placeholder:"000000"})]}),(0,i.jsx)("button",{type:"submit",disabled:c,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Verifying...":"Verify Code"}),(0,i.jsx)("button",{type:"button",className:"w-full text-sm text-blue-600 hover:text-blue-500",disabled:c,onClick:g,children:"Resend verification code"})]})]}),3===a&&(0,i.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),(0,i.jsx)("input",{id:"firstName",name:"firstName",type:"text",required:!0,value:e.firstName,onChange:f,className:"input-field"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),(0,i.jsx)("input",{id:"lastName",name:"lastName",type:"text",required:!0,value:e.lastName,onChange:f,className:"input-field"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"middleName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Middle Name"}),(0,i.jsx)("input",{id:"middleName",name:"middleName",type:"text",value:e.middleName,onChange:f,className:"input-field"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),(0,i.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:e.password,onChange:f,className:"input-field",placeholder:"At least 8 characters"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),(0,i.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:e.confirmPassword,onChange:f,className:"input-field"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),(0,i.jsx)("input",{id:"phoneNumber",name:"phoneNumber",type:"tel",value:e.phoneNumber,onChange:f,className:"input-field",placeholder:"+639123456789"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),(0,i.jsx)("input",{id:"dateOfBirth",name:"dateOfBirth",type:"date",value:e.dateOfBirth,onChange:f,className:"input-field"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),(0,i.jsx)("textarea",{id:"address",name:"address",rows:3,value:e.address,onChange:f,className:"input-field",placeholder:"Complete address"})]}),(0,i.jsx)("button",{type:"submit",disabled:c,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Creating Account...":"Create Account"})]}),(0,i.jsx)("div",{className:"mt-6 text-center",children:(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,i.jsx)(l.default,{href:"/login",className:"text-blue-600 hover:text-blue-500 font-medium",children:"Sign in"})]})})]})})})}},6553:function(e,t,a){"use strict";a.d(t,{O:function(){return i}});let i=(0,a(9793).eI)("https://gcvvoixmucjbhxfqfkxl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdjdnZvaXhtdWNqYmh4ZnFma3hsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2NzQ4NDIsImV4cCI6MjA3MzI1MDg0Mn0.5pEWmrSpk8Ic3OpPv7gZ67OWLdx1aMNsYkT785CeivE")}},function(e){e.O(0,[2727,9793,5275,5248,5633,1744],function(){return e(e.s=7868)}),_N_E=e.O()}]);