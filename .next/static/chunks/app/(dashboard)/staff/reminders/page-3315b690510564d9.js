(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9162],{1072:function(e,t,s){Promise.resolve().then(s.bind(s,8372))},1509:function(e,t,s){"use strict";var r=s(5658);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},8372:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var r=s(9692),a=s(9693),i=s(1509);function l(){(0,i.useRouter)();let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)([]),[n,d]=(0,a.useState)([]),[c,o]=(0,a.useState)(!0),[u,x]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),[h,p]=(0,a.useState)({title:"",message:"",reminder_type:"general",priority:"medium",target_audience:"all_students",target_user_ids:[],target_course_ids:[],is_dismissible:!0,expires_at:""});(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{o(!0);let s=await fetch("/api/admin/reminders");if(s.ok){let e=await s.json();t(e.reminders||[])}let r=await fetch("/api/staff/courses");if(r.ok){let e=await r.json();l(e.courses||[])}let a=await fetch("/api/admin/users");if(a.ok){var e;let t=await a.json();d((null===(e=t.users)||void 0===e?void 0:e.filter(e=>"student"===e.role))||[])}}catch(e){console.error("Error fetching data:",e)}finally{o(!1)}},f=async e=>{e.preventDefault();try{let e=m?{id:m.id,...h}:h,t=await fetch("/api/admin/reminders",{method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)await b(),v(),x(!1),g(null);else{let e=await t.json();alert("Error: ".concat(e.error))}}catch(e){console.error("Error saving reminder:",e),alert("Error saving reminder")}},y=async e=>{if(confirm("Are you sure you want to delete this reminder?"))try{let t=await fetch("/api/admin/reminders?id=".concat(e),{method:"DELETE"});if(t.ok)await b();else{let e=await t.json();alert("Error: ".concat(e.error))}}catch(e){console.error("Error deleting reminder:",e),alert("Error deleting reminder")}},j=e=>{g(e),p({title:e.title,message:e.message,reminder_type:e.reminder_type,priority:e.priority,target_audience:"all_users"===e.target_audience||"staff_only"===e.target_audience||"admin_only"===e.target_audience?"all_students":e.target_audience,target_user_ids:e.target_user_ids||[],target_course_ids:e.target_course_ids||[],is_dismissible:e.is_dismissible,expires_at:e.expires_at?new Date(e.expires_at).toISOString().slice(0,16):""}),x(!0)},v=()=>{p({title:"",message:"",reminder_type:"general",priority:"medium",target_audience:"all_students",target_user_ids:[],target_course_ids:[],is_dismissible:!0,expires_at:""})},_=async e=>{try{(await fetch("/api/admin/reminders",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,is_active:!e.is_active})})).ok&&await b()}catch(e){console.error("Error toggling reminder status:",e)}},N=e=>{switch(e){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},w=e=>{switch(e){case"announcement":return"\uD83D\uDCE2";case"deadline":return"⏰";case"maintenance":return"⚠️";case"course_update":return"\uD83D\uDCDA";case"assignment":return"\uD83D\uDCDD";case"exam":return"\uD83D\uDCCB";case"event":return"\uD83D\uDCC5";default:return"ℹ️"}},C=e=>!0;return c?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Student Reminders"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Create and manage reminders for your students."})]}),(0,r.jsx)("button",{onClick:()=>{v(),g(null),x(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium",children:"Create Reminder"})]})}),u&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:m?"Edit Reminder":"Create New Reminder"}),(0,r.jsx)("button",{onClick:()=>{x(!1),g(null),v()},className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,r.jsx)("input",{type:"text",value:h.title,onChange:e=>p({...h,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,r.jsx)("textarea",{value:h.message,onChange:e=>p({...h,message:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,r.jsxs)("select",{value:h.reminder_type,onChange:e=>p({...h,reminder_type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"general",children:"General"}),(0,r.jsx)("option",{value:"announcement",children:"Announcement"}),(0,r.jsx)("option",{value:"deadline",children:"Deadline"}),(0,r.jsx)("option",{value:"course_update",children:"Course Update"}),(0,r.jsx)("option",{value:"assignment",children:"Assignment"}),(0,r.jsx)("option",{value:"exam",children:"Exam"}),(0,r.jsx)("option",{value:"event",children:"Event"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,r.jsxs)("select",{value:h.priority,onChange:e=>p({...h,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"urgent",children:"Urgent"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Audience"}),(0,r.jsxs)("select",{value:h.target_audience,onChange:e=>p({...h,target_audience:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"all_students",children:"All Students"}),(0,r.jsx)("option",{value:"specific_students",children:"Specific Students"}),(0,r.jsx)("option",{value:"course_students",children:"Course Students"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Staff can only send reminders to students"})]}),"specific_students"===h.target_audience&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Students"}),(0,r.jsx)("select",{multiple:!0,value:h.target_user_ids,onChange:e=>p({...h,target_user_ids:Array.from(e.target.selectedOptions,e=>e.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32",children:n.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.email,")"]},e.id))}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple students"})]}),"course_students"===h.target_audience&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Courses"}),(0,r.jsx)("select",{multiple:!0,value:h.target_course_ids,onChange:e=>p({...h,target_course_ids:Array.from(e.target.selectedOptions,e=>e.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32",children:s.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.code," - ",e.title]},e.id))}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple courses"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires At (Optional)"}),(0,r.jsx)("input",{type:"datetime-local",value:h.expires_at,onChange:e=>p({...h,expires_at:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_dismissible",checked:h.is_dismissible,onChange:e=>p({...h,is_dismissible:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"is_dismissible",className:"ml-2 block text-sm text-gray-700",children:"Allow students to dismiss this reminder"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{x(!1),g(null),v()},className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:[m?"Update":"Create"," Reminder"]})]})]})]})})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"All Reminders"})}),(0,r.jsxs)("div",{className:"overflow-x-auto",children:[(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reminder"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type & Priority"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Target Audience"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("span",{className:"text-lg",children:w(e.reminder_type)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsx)("div",{className:"text-sm text-gray-500 line-clamp-2",children:e.message})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.reminder_type.replace("_"," ").toUpperCase()}),(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(N(e.priority)),children:e.priority.toUpperCase()})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.target_audience.replace("_"," ").toUpperCase()}),(0,r.jsx)("td",{className:"px-6 py-4",children:C(e)?(0,r.jsx)("button",{onClick:()=>_(e),className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"}):(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,r.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:[(0,r.jsx)("div",{children:new Date(e.created_at).toLocaleDateString()}),(0,r.jsxs)("div",{className:"text-xs",children:["by ",e.created_by_user.first_name," ",e.created_by_user.last_name]})]}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm font-medium space-x-2",children:C(e)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>j(e),className:"text-blue-600 hover:text-blue-900",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>y(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})})]},e.id))})]}),0===e.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCE2"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No reminders yet"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Create your first reminder to get started."}),(0,r.jsx)("button",{onClick:()=>{v(),g(null),x(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium",children:"Create Reminder"})]})]})]})]})}}},function(e){e.O(0,[5248,5633,1744],function(){return e(e.s=1072)}),_N_E=e.O()}]);